# 3.1 전송 계층 서비스 및 개요
### 전송 계층 프로토콜
- 서로 다른 호스트에서 동작하는 **애플리케이션 프로세스**들 간의 **논리적 통신** 제공
    - 논리적 통신 : 프로세스들이 동작하는 **호스트들이 직접 연결된 것처럼 보이는 것**
- 네트워크 라우터가 아닌 **종단 시스템에서 구현**된다.
    1. 송신 측의 애플리케이션 프로세스로부터 수신한 `메세지`를 전송 계층 `세그먼트(segment)`로 변환한다.
        - 메세지를 작은 조각으로 **분할**하고
        - 각각의 조각에 전송 계층 **헤더를 추가**한다.
    2. 전송 계층은 네트워크 계층으로 세그먼트를 전달하고, 세그먼트는 네트워크 계층 `데이터그램(datagram)`안에 **캡슐화**되어 전달된다.
        - 네트워크 라우터는 데이터그램의 네트워크 계층 필드에 대해서만 동작하고, 전송 계층 필드를 검사하지 않는다.
    3. 수신 측에서 네트워크 계층은 데이터그램으로부터 **전송 계층 세그먼트를 추출**하고 전송 계층으로 세그먼트를 보낸다.
- TCP와 UDP라는 두가지 프로토콜을 가지고 있다.
> **캡슐화** 과정을 거쳐 전송되고, 수신시 각 계층 필드를 **추출**한다.

## 3.1.1 전송 계층과 네트워크 계층 사이의 관계

### 전송 계층
- 네트워크 계층 바로 상위에 존재한다.
- 서로 다른 호스트에서 동작하는 **프로세스들 사이의 논리적 통신을 제공**한다.
> 프로세스들이 직접 연결된 것처럼 서비스를 제공한다.
### 네트워크 계층
- **호스트들 사이의 논리적 통신을 제공**한다.
> 호스트들이 직접 연결된 것처럼 서비스를 제공한다.

#### 예시
사촌끼리 메세지를 주고 받는다.
앤과 빌은 메세지를 수거하고 우편부에게 전달하는 역할을 한다.

- 프로세스= 사촌 형제
- 애플리케이션 메세지 = 봉투 안의 편지
- 전송 계층 프로토콜 = 앤과 빌
> 사촌형제(프로세스)입장에서는 앤과 빌이 메세지를 전달하는 것처럼 보인다.
- 호스트 = 집
- 네트워크 계층 프로토콜 = 우편 서비스

### 전송 계층이 전달할 수 있는 서비스
- 애플리케이션에게 신뢰적인 데이터 전송 서비스나 암호화 서비스를 제공할 수 있다.

## 3.1.2 인터넷 전송 계층의 개요
### TCP/IP가 제공하는 전송 계층 프로토콜
- **TCP**: 애플리케이션에게 **신뢰적이고 연결 지향 서비스를 제공**한다.
- **UDP** : 애플리케이션에게 **비신뢰적이고 비연결형 서비스를 제공**한다.
> 애플리케이션 개발자는 소켓을 생성할 때 TCP와 UDP 중에서 하나를 선택해야 한다.

### IP(Internet Protocol)
- 인터넷의 **네트워크 계층 프로토콜** = 인터넷 프로토콜 = IP
- **최선형 전달 서비스**
    - IP가 통신하는 **호스트들 간에 데이터그램을 전달하기 위해서 최대한 노력하지만,** **어떤 보장도 하지 않는다**.
    - 데이터그램의 전달을 보장하지 않고, 데이터그램이 순서대로 전달하는 것도 보장하지 않는다.
    - 데이터그램 내부 데이터의 무결성을 보장하지 않는다.
    - **IP는 비신뢰적인 서비스**라고 불린다.
> 각 호스트는 적어도 하나의 IP 주소를 가지고 있다.

### TCP와 UDP의 서비스 모델
- `TCP`와 `UDP`는 **종단 시스템 사이의 IP 전달 서비스**를 종단 시스템에서 동작하는 **두 프로세스 간의 전달 서비스**로 **확장**한다.
    - "호스트-대-호스트 전달"을 "프로세스-대-프로세스 전달"로 확장한다.
    - 이를 **트랜스포트 다중화**와 **역다중화**라고 부른다.
- TCP와 UDP는 헤더에 오류 검출 필드를 포함함으로써 무결성 검사를 제공한다.
> 최소한의 전송 계층 서비스인 **프로세스 대 프로세스 데이터 전달**과 **오류 검출**을 UDP가 제공한다.
UDP는 전송된 데이터가 손상되지 않고 목적지 프로세스에 도착한다는 것을 보장하지 않는다.

### TCP
- 전송 계층 서비스에 더해 추가적인 서비스를 제공한다.

1. **신뢰적인 데이터 전달**을 제공한다.
    - 흐름 제어, 순서번호, 확인응답, 타이머를 사용함으로써 송신 프로세스가 수신 프로세스에게 데이터가 순서대로 정확하게 전달되도록 한다.
    - TCP는 **종단 시스템(호스트) 간에 IP의 비신뢰적인 서비스를 프로세스 사이의 신뢰적인 데이터 전송 서비스**로 만들어준다.
2. **혼잡제어**를 사용한다.
    - 혼잡제어란 **전체를 위한 일반 서비스**이다.
    - 한 TCP 연결이 과도한 양의 트래픽으로 모든 통신하는 호스트들 사이의 스위치와 링크를 폭주되게 하는 것을 방지한다.
    - 혼잡한 네트워크 링크에서 **각 TCP 연결이 링크의 대역폭을 공평하게 공유**하여 통과하도록 한다.
        - 송신 측의 TCP가 네트워크에 보낼 수 있는 트래픽을 조절함으로써 수행된다.
        - UDP 트래픽은 조절되지 않고 허용이 되는 한 어떤 속도로든 전달할 수 있다.
> 대역폭 : 주어진 시간동안 네트워크 연결을 통해 전송할 수 있는 데이터의 최대량
