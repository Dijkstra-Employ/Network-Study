# 2.1 네트워크 애플리케이션의 원리
### 네트워크 애플리케이션
- **다른 종단 시스템**에서 동작
- **네트워크를 통해 서로 통신**하는 프로그램
> ex) 서버-클라이언트, P2P: 각 호스트에 있는 프로그램, 브라우저-웹서버

#### 네트워크 애플리케이션은 종단 시스템에서만 동작한다.
- 라우터나 링크 계층 스위치와 같이 **네트워크 코어 장비를 위한 애플리케이션 소프트웨어를 개발할 수 없다.**
    - 네트워크 코어 장비는 네트워크 계층 및 그 하위 계층에서만 기능하기 때문이다.
- 종단 시스템에만 애플리케이션 소프트웨어가 존재한다.
> 네트워크 애플리케이션을 위한 통신은 종단 시스템 간의 애플리케이션 계층에서 발생한다.

## 2.1.1 네트워크 애플리케이션 구조
#### 애플리케이션 구조는 네트워크 구조와 다르다.
- 네트워크 구조
    - 고정되어 있고, 애플리케이션에 특정 서비스 집합을 제공한다.
- 애플리케이션 구조
    - 애플리케이션 개발자에 의해 설계된다.
    - 애플리케이션이 다양한 종단 시스템에서 어떻게 조직되어야 하는지 지시한다.
    - **클라이언트-서버** 구조와 **P2P** 구조 중에 하나이다.

### 1. 클라이언트-서버 구조
- 서버
    - 항상 켜져있는 호스트이다.
    - 클라이언트로부터 많은 요청을 받는다.
    - 고정 IP를 갖는다.
- 클라이언트
    - 가끔 혹은 항상 켜져있는 호스트이다.
    - 클라이언트 서로 직접적으로 통신하지 않는다.
    - 서버에 항상 연결할 수 있다.
- 동작
    - 웹서버가 클라이언트 호스트로부터 객체를 요청받으면 웹 서버는 클라이언트 호스트로 요청된 객체를 보내어 응답한다.

#### 데이터 센터
- 하나의 서버 호스트가 많은 클라이언트의 요청에 응답하는 것은 불가능하다.
- **많은 수를 갖춘 호스트**로, **강력한 가상의 서버를 생성**한다.
- 전력이 공급되어야 하고, 관리되어야 하는 10만 개 정도의 서버를 갖춘다.
- 서비스 제공자들은 데이터 센터로부터 데이터를 보내기 위해 상호연결과 대역폭에 대한 비용을 (네트워크 사업자-데이터 센터 소유자에게) 지불한다.

> 인기 있는 서비스는 하나 이상의 데이터 센터를 사용한다.

### 2. P2P 구조
- 항상 켜져 있는 기반구조 서버에 최소로 의존한다.
- peer(피어) - 간헐적으로 연결된 호스트쌍이 서로 직접 통신한다.
    - 서비스 제공자가 소유하지 않고, 사용자들이 제어하는 데스크톱과 랩톱이다.
    - 서버를 통하지 않고 피어끼리 직접 소통하므로 peer to peer(P2P)이다.
    - 파일을 내려받는 피어를 **클라이언트**, 파일을 올리는 피어를 **서버**라고 한다.
- 인기 있고 트래픽 집중적인 애플리케이션들은 P2P 구조에 기반을 두고 있다.
    - BitTorrent, Skype ...

#### P2P - 자가 확장성
- ex) P2P 파일 공유 애플리케이션
    - 각 피어들이 파일을 요구함으로써 작업 부하를 만들어낸다.
    - 각 피어들은 파일을 다른 피어들에게 분배함으로써 그 시스템에 서비스 능력을 추가한다.

#### P2P - 비용 효율적
- P2P는 상당한 서버 기반구조와 서버 대역폭을 요구하지 않는다.

> 고도의 분산 구조 특성으로 인해 보안, 성능, 신뢰성에 도전을 맞고 있다.

### 하이브리드
- 클라이언트-서버 + P2P 구조
- 서버는 사용자의 IP주소를 추적하는데 사용되며, 사용자간 메세지는 사용자 호스트 사이에 직접 전달된다.

## 2.1.2. 프로세스간 통신
- 여러 종단 시스템에서 실행하는 프로그램이 서로 통신하는 방법
    - 실제 통신하는 것 : **프로세스**( = 종단 시스템에서 실행되는 프로그램)
- **같은 종단 시스템** 내에서 통신 : **프로세스 간 통신**하며, 종단 시스템의 **운영체제**에 의해 결정된다.
- **다른 종단 시스템** 내에서 통신 : 프로세스는 **컴퓨터 네트워크를 통해 메세지를 교환하며 통신**한다.
    - 송신 프로세스는 메세지를 만들어 네트워크에 보낸다.
    - 수신 프로세스는 메세지를 받고 역으로 메세지를 보냄으로써 응답한다.

### 클라이언트와 서버 프로세스
- 네트워크 애플리케이션은 네트워크에서 서로 메세지를 보내는 두 프로세스로 구성된다.
    - 두 프로세스 간의 통신 세션에서 **통신을 초기화하는 프로세스를 클라이언트**라고 하고, **세션을 시작하기 위해 접속을 기다리는 프로세스를 서버**라고 한다.
> 통신 초기화: 다른 프로세스와 세션을 시작하려고 접속을 초기화

### 프로세스와 컴퓨터 네트워크 사이의 인터페이스 : 소켓
- **애플리케이션** : 두 프로세스가 메세지를 서로에게 보내는 통신 프로세스 쌍
- 하나의 프로세스로부터 다른 프로세스로 보내는 **메세지는 네트워크를 통해 움직인다.**
    - 프로세스는 **소켓**을 통해 네트워크로 메세지를 보내고 받는다.
    - 프로세스: 집, 소켓: 출입구
- 애플리케이션 개발자는 **소켓의 애플리케이션 게층에 대한 모든 통제권**을 갖지만, **전송 계층에 대한 통제권은 거의 갖지 못한다.**
    - 전송 프로토콜의 선택과 전송 계층 매개변수의 설정만 통제할 수 있다.

#### 소켓이란?
- 호스트의 **애플리케이션 프로세스와 전송 계층 프로토콜 간의 인터페이스**
    - 송신 측의 애플리케이션은 소켓을 통해 메세지를 보낸다. 전송 프로토콜은 네트워르르 통해 그 메세지를 수신 프로세스의 소켓으로 이동시킨다.
    - 애플리케이션과 네트워크 사이의 API(서로 상호작용)
    - 프로그래머가 **네트워크를 통신을 쉽게 구현**할 수 있게 해준다.
- 컴퓨터 **네트워크에서 데이터를 주고받기 위한 엔드포인트**
- **IP 주소와 포트 번호**의 조합으로 네트워크 상의 특정 프로세스를 식별하여 통신한다.
- **파일과 유사하게 취급**되어, 읽기와 쓰기 작업을 통해 데이터를 송수신한다.
- TCP나 UDP와 같은 **다양한 전송 프로토콜을 지원**한다.
> 전기 소켓이 전자기기를 전력망에 연결해주는 것과 비슷한 개념이다.

### 프로세스 주소 배정
- 수신 프로세스를 식별하기 위해 IP 주소와 포트번호가 필요하다.
    - **IP 주소** : **호스트를 식별**하며 32비트로 구성된다.
    - 포트번호: 수신 호스트에서 수행하는 **수신 프로세스를 식별**한다.
> 한 호스트가 많은 네트워크 응용을 수행할 수 있기 때문이다.

## 2.1.3 애플리케이션이 이용 가능한 트랜스포트 서비스
- 인터넷을 포함한 많은 네트워크들은 하나 이상의 전송 프로토콜을 제공한다.
    - **애플리케이션 요구에 가장 적합한 서비스를 제공하는 프로토콜을 선택**해야한다.
- 전송 계층 프로토콜이 애플리케이션에 제공할 수 있는 서비스로 **신뢰적 데이터 전송, 처리율, 시간, 보안** 4가지로 분류할 수 있다.

### 신뢰적 데이터 전송
- 패킷들은 컴퓨터 네트워크 내에서 손실될 수 있다.
- **신뢰적 데이터 전송**
    - 애플리케이션이 보낸 데이터가 올바르고 완전히 다른 애플리케이션에 전달되도록 보장한다.
    - 즉, 보장된 데이터 전송 서비스를 제공한다.
    - 송신 프로세스는 데이터를 소켓으로 보내고 그 데이터가 오류 없이 수신 프로세스에 도착할 것이라는 확신을 갖는다.
- **손실 허용 애플리케이션**
    - 신뢰적 데이터 전송을 제공하지 않는 프로토콜을 선택할 수 있다.
    - 멀티 미디어 애플리케이션은 손실 데이터로 인해 오디오/비디오의 품질에 약간의 영향만 받는다. (심각한 영향을 받지 않는다.)

### 처리량
- **처리율** : 송신 프로세스가 수신 프로세스로 비트를 전달할 수 있는 비율
- 다른 세션들과 대역폭을 공유하므로, 가용 처리율은 시간에 따라 변동한다.
- 전송 프로토콜은 가용한 처리율이 항상 적어도 r bps임을 보장할 수 있다.
- 대역폭 민감 애플리케이션 : 처리율 요구사항을 갖는 애플리케이션
    - 많은 현존하는 멀티미디어 애플리케이션은 대역폭에 민감하다.
- 탄력적 애플리케이션
    - 가용한 처리율에 많고 적음에 큰 영향을 받지 않고 이용이 가능하다.

### 시간
- 시간 보장
    - 데이터 전송에 **엄격한 시간제한 조건**을 요구한다.
    - ex) 송신자가 소켓으로 내보내는 모든 비트가 수신자의 소켓에 100msec 내에 도착한다.
    - 상호 작용 실시간 애플리케이션에 사용된다.

### 보안
- 전송 프로토콜은 애플리케이션에 하나 이상의 **보안 서비스**를 제공할 수 있다.
- 데이터 암호화, 데이터 무결성, 종단 인증등이 포함된다.

## 2.1.4 인터넷 전송 프로토콜이 제공하는 서비스
- 인터넷(일반적인 TCP/IP)는 애플리케이션에게 TCP, UDP를 제공한다.

### TCP 서비스
- **연결 지향형 서비스**
    - 애플리케이션 계층 메세지를 전송하기 전에 TCP는 클라이언트와 서버가 서로 전송 제어 정보를 교환하도록 한다. (**핸드쉐이킹**)
        - 서로 통신 준비가 되었을 때 데이터를 전송한다.
    - 두 프로세스의 소켓 사이에 TCP 연결이 존재하고, 두 프로세스가 서로에게 동시에 메세지를 보낼 수 있다. (**전이중 연결**)
- **신뢰적인 데이터 전송 서비스**
    - 애플리케이션 한 쪽이 바이트 스트림을 소켓으로 전달하면, 그 **바이트 스트림을 손실하거나 중복되지 않게 수신 소켓으로 전달**한다.
- + **혼잡제어**
    - 통신하는 프로세스의 직접 이득보다는 인터넷 전체 성능 향상을 위한 서비스이다.
    - **네트워크가 혼잡 상태에 이르면 프로세스 속도를 낮춘다.**
    - 각 TCP 연결이 **네트워크 대역폭을 공평하게 공유**할 수 있게 한다.
> 전자메일, 웹, 파일 전송 등의 애플리케이션은 신뢰적 데이터 전송 서비스를 제공하기 때문에 TCP를 선택했다.

### UDP 서비스
- **비연결형**
    - 두 프로세스가 통신을 하기 전에 핸드쉐이킹을 하지 않는다.
    - 하나의 프로세스가 UDP 소켓으로 메세지를 보내면 도착하는 메세지들의 순서가 뒤바뀔 수도 있다.
- **혼잡 제어를 하지 않는다.**
    - UDP의 송신 측은 데이터를 원하는 속도로 하위 계층으로 보낼 수 있다.
> 인터넷 전화 응용은 보통 패킷 손실을 허용하지만 효율성을 위해 최소의 전송속도를 필요로 하므로 UDP를 선호한다.
> 이를 통해 TCP의 혼잡제어와 패킷 오버헤드를 회피할 수 있다.
> => 많은 방화벽들이 UDP 트래픽을 차단하도록 설정되어 있기 때문에 UDP 통신이 실패할 경우를 대비하여 TCP를 사용하도록 설계되어 있다.

#### TCP와 UDP가 공존하는 네트워크
- UDP는 혼잡 제어를 하지 않기 때문에 네트워크 상황에서 TCP가 불리해보일 수 있지만, 실제로는 그렇지 않다.
- 대부분의 라우터는 공정성 메커니즘을 구현하여 UDP 트래픽이 TCP를 앞서가지 못하게 한다.
- 네트워크 관리자들은 UDP를 TCP보다 우선순위를 낮추는 정책을 수행하기도 한다.

### 인터넷 전송 프로토콜이 제공하지 않는 서비스
- TCP는 신뢰적 종단간 데이터 전송(신뢰적 데이터 전송)을 제공한다.
- TCP는 SSL을 통해 보안 서비스를 제공할 수 있다.
- TCP와 UDP에서 시간 혹은 대역폭 보장을 제공할 수는 없다.

## 2.1.5 애플리케이션 계층 프로토콜
- 네트워크 프로세스는 소켓으로 메세지를 보냄으로써 통신한다.
- 애플리케이션 계층 프로토콜
    - **다른 종단 시스템에서 실행되는 애플리케이션의 프로세스가 서로 메세지를 보내는 방법**
    - 교환 메세지 타입, 여러 메세지 타입의 문법, 필드의 의미, 언제 어떻게 프로세스가 메세지를 전송하고 메세지에 응답하는지 결정하는 규칙
- 여러 애플리케이션 계층 프로토콜은 RFC에 명시되어 있으므로 public domain(공중 도메인)에서 찾을 수 있다.
    - ex) HTTP
- 많은 다른 애플리케이션 계층 프로토콜들은 독점이며 공중 도메인에서 구할 수 없다.
    - ex) Skype

#### 애플리케이션 계층 프로토콜은 네트워크 애플리케이션의 한 요소이다.
- 웹 : 네트워크 애플리케이션
    - 사용자가 필요에 따라 웹 서버로부터 문서를 얻게 해준다.
    - HTML, 웹 브라우저, 웹 서버 등등
- HTTP : 웹 애플리케이션 계층 프로토콜
    - 브라우저와 웹 서버 사이에서 교환되는 메세지 포맷과 순서 정의
- 인터넷 전자메일 : 네트워크 애플리케이션
    - 메일서버, 메일 클라이언트 등이 있다.
- SMTP : 전자메일에 대한 주요 애플리케이션 계층 프로토콜
    - 인터넷 전자메일의 한 요소이다.

## 2.1.6 이 책에서 다루는 네트워크 애플리케이션
- 웹,파일 전송, 전자메일, 디렉터리 서비스, 비디오 스트리밍, P2P 애플리케이션을 다룬다.
