## 2.3 Electronic Mail in the Internet
전자메일은 인터넷이 시작된 이래로 계속 존재해왔다. **전자 메일은 비동기 통신 매체이기 때문에 다른 사람의 일정에 맞출 필요 없이 편리한 시간에 메세지를 보내고 읽을 수 있다.**

![](https://velog.velcdn.com/images/choiyoung6609/post/62b4df65-2895-45cf-8ec3-50d12c00bfb3/image.png)

- 위의 사진에서 구성요소는 **사용자 에이전트, 메일 서버 및 SMTP**이다.
- 사용자가 메세지 작성을 마치면 사용자 에이전트는 해당 메세지를 메일 서버로 보낸다. 메세지가 발신 메세지 대기열에 배치되고 Bob이 메세지를 읽으려고 하면 그의 사용자 Agent는 그의 메일 서버에 있는 편지함에서 메세지를 검색한다.
- 각 수신자는 메일 서버에 하나의 문서함을 가지고 있다. 
- 수신자가 메일을 읽기 위해서는 사용자 인증을 거쳐야 한다.
- 송신자의 메일 서버는 수신자 메일 서버의 오류도 처리해야 한다.

SMTP는 **인터넷 전자 메일의 주요 응용 프로그램 계층 프로토콜**이다. TCP를 사용하여 안정적으로 데이터를 전송한다. 메일 서버는 다른 서버로 메일을 보낼 때 **SMTP 클라이언트 역할**을 하며 다른 서버로부터 메일을 받을 때는 **SMTP 서버 역할**을 한다.

---

### SMTP
SMTP는 모든 메세지의 본문을 간단한 7bit 아스키로 제한한다. 그러나 현재는 멀티미디어 세대로서 **SMTP를 전송하기 전에 바이너리 멀티미디어 데이터를 ASCII로 인코딩**해야 한다.

1. 송신자는 이메일을 보내기 위해 자신의 사용자 에이전트를 호출하여 수신자의 이메일 주소, 메세지를 작성하여 메세지를 보내도록 지시한다.
2. 사용자 에이전트가 메세지를 송신자의 메일 서버로 보낸다.
3. SMTP 클라이언트 측은 메세지 대기열에서 메세지를 보고 수신자의 멩리 서버에서 실행되는 SMTP 서버에 대한 TCP 연결을 시도한다.
4. 수신자의 메일 서버에서 SMTP의 서버 측이 메세지를 수신한다. 이후, 수신자의 메일함에 메세지를 넣는다.
5. 자신이 원하는 시간에 수신자는 사용자 에이전트를 호출하여 자신의 메일을 읽는다.

### 메일 메세지 형식
![](https://velog.velcdn.com/images/choiyoung6609/post/e2f720b6-a8bf-483f-9efa-ca1ce2a048f5/image.png)

HTTP와 마찬가지로 SMTP도 형식이 존재한다. 수신자의 주소, 자신의 반송 주소 같은 주변 헤더 정보가 포함될 수도 있다. 헤더 라인과 메세지 본문은 빈 라인으로 구분된다. HTTP 마찬가지로 일부는 필수고 일부는 선택사항이다. 
