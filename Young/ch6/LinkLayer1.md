# 링크 계층과 근거리 네트워크

## 6.1 링크 계층 소개
- **노드** : 링크 계층 프로토콜을 실행하는 장치(호스트, 라우터, 스위치, 와이파이AP 등)
- **링크** : 인접한 **노드**들을 연결하는 통신 채널

- 데이터그램을 목적지로 이동시키기 위해서는 **경로의 개별 링크들**을 이용해야 한다.

![](https://velog.velcdn.com/images/choiyoung6609/post/86ef9365-960e-4eed-907d-8139b79a8e07/image.png)

- 전송 노드에서는 데이터그램을 **링크 계층 프레임**으로 캡슐화하여 전달한다.

### 6.1.1 링크 계층이 제공하는 서비스
링크 계층의 역할은 한 노드에서 인접한 다른 노드로 프레임을 이동시키는 것이지만, **세부사항**은 **특정 링크 프로토콜**을 따른다.

- **프레임화** : 링크 계층 프로토콜은 링크상으로 데이터그램을 전송하기 위해 **링크 계층 프레임으로 캡슐화**한다. 그러나, 프레임의 구조는 **링크 계층 프로토콜**마다 **다르다**

- **링크 접속**  : _매체 접속 제어(MAC) 프로토콜_은 링크 상으로 프레임을 전송하는 규칙을 명시한다. **점대점 연결**의 경우 MAC 프로토콜은 **단순하거나 없으며***, 링크가 사용되지 않을 때마다 프레임 전송이 가능하다. 그러나, **브로드캐스트** 링크를 여러 노드가 **공유**하는 경우 _MAC 프로토콜은 여러 노드로부터의 프레임 전송을 조정_한다.

- **신뢰적 전달** : 링크 계층 프로토콜은 신뢰적 전달을 제공할 수 있는데, 이 경우 링크 상에서 오류가 없이 전달된다.(확인 응답과 재전송 이용) 그러나, **낮은 비트 오류율을 가진 링크**에서는 불필요한 **오버헤드**일 수 있다. 따라서, **대다수의 "유선" 링크에서는 제공하지 않는다.**

- **오류 검출과 정정** : 링크 계층 하드웨어는 비트를 잘못 오인할 수 있다. 송신 노드에서 오류 검출 비트를 설정하면, 수신 노드에서 오류 검사를 수행하게 한다. **링크 계층에서 오류 검출은 하드웨어로 구현**되며, 오류 발생 비트를 **정확하게 찾아낼 수 있다(정정 가능).** 


### 6.1.2 링크 계층이 구현되는 위치
![](https://velog.velcdn.com/images/choiyoung6609/post/5999f9cf-4acc-4808-a8db-5daeb92c4f31/image.png)

위의 그림은 일반적인 호스트 내부의 구조이다.

- 이더넷 기능 : 마더보드 칩셋에 통합되거나, 저가의 이더넷 전용 칩으로 구현된다.

- **Network Interface Controller(NIC)**로 알려진 **네트워크 어댑터**에 링크 계층이 대부분 구현된다.

- 어댑터 안에는 **링크 계층 컨트롤러**가 있으며, 이 컨트롤러에서는 앞서 설명한 **링크 계층 서비스의 대다수가 구현**되어 있다. 이때 **컨트롤러의 기능 대부분은 하드웨어**로 구현된다. 

- 송신 측 컨트롤러는 프레임화하여 링크 상으로 전송하고, 수신 상에서는 만약 오류 검출을 하는 경우 **오류 검출을 수행**하고, **네트워크 계층 데이터그램**을 추출한다.

- 대부분의 링크 계층 기능은 NIC에 구현되어 있지만, 일부 기능은 **호스트의 CPU**에 구현되어 있다.(링크 계층 주소 정보 조립, 컨트롤러 하드웨어의 활성화) 

- 호스트의 CPU<상위 레벨의 링크 계층 기능>은 컨트롤러로부터의 _인터럽트에 응답_하고 _오류 조건을 처리_하며 데이터그램을 _네트워크 계층으로 전달_하는 일을 수행한다. 

- 즉, **링크 계층은 하드웨어와 소프트웨어의 조합**이이다.
